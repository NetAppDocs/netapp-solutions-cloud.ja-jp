---
sidebar: sidebar 
permalink: vmware/vmw-gcp-gcve-guest-storage.html 
keywords: NetApp Solutions, google cloud, gcp, gcve, enterprise, hybrid, cloud, cloud volumes ontap, cvo 
summary:  
---
= GCP 向けNetAppストレージ オプション
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
GCP は、Cloud Volumes ONTAP (CVO) またはGoogle Cloud NetApp Volumes (NetApp Volumes) を使用してゲスト接続されたNetAppストレージをサポートします。



== Cloud Volumes ONTAP（CVO）

Cloud Volumes ONTAP(CVO) は、NetApp のONTAPストレージ ソフトウェア上に構築された業界をリードするクラウド データ管理ソリューションであり、Amazon Web Services (AWS)、Microsoft Azure、Google Cloud Platform (GCP) でネイティブに利用できます。

これはクラウドネイティブ ストレージを使用するONTAPのソフトウェア定義バージョンであり、クラウドとオンプレミスで同じストレージ ソフトウェアを使用できるため、データを管理するためのまったく新しい方法について IT スタッフを再トレーニングする必要性が軽減されます。

CVO により、エッジからデータセンター、クラウドへとシームレスにデータを移動し、ハイブリッド クラウドを統合することが可能になります。これらはすべて、単一ペインの管理コンソールであるNetApp Cloud Manager で管理されます。

CVOは設計上、クラウドで最も要求の厳しいアプリケーションにも対応できる優れたパフォーマンスと高度なデータ管理機能を提供します。



=== ゲスト接続ストレージとしてのCloud Volumes ONTAP (CVO)

.Google Cloud にCloud Volumes ONTAPをデプロイする（自分で行う）
[%collapsible%open]
====
Cloud Volumes ONTAP共有と LUN は、GCVE プライベート クラウド環境で作成された VM からマウントできます。  Cloud Volumes ONTAP はiSCSI、SMB、NFS プロトコルをサポートしているため、ボリュームは Linux クライアントと Windows クライアントにマウントすることもでき、iSCSI 経由でマウントすると、Linux または Windows クライアントでブロック デバイスとして LUN にアクセスできます。  Cloud Volumes ONTAPボリュームは、いくつかの簡単な手順でセットアップできます。

障害復旧または移行の目的でオンプレミス環境からクラウドにボリュームを複製するには、サイト間 VPN または Cloud Interconnect を使用して Google Cloud へのネットワーク接続を確立します。オンプレミスからCloud Volumes ONTAPへのデータの複製については、このドキュメントの範囲外です。オンプレミスとCloud Volumes ONTAPシステム間でデータを複製するには、link:mailto:CloudOwner@gve.local#setting-up-data-replication-between-systems["システム間のデータ複製の設定"] 。


NOTE: 使用link:https://cloud.netapp.com/cvo-sizer["Cloud Volumes ONTAPサイザー"]Cloud Volumes ONTAPインスタンスのサイズを正確に決定します。また、オンプレミスのパフォーマンスを監視して、 Cloud Volumes ONTAPサイザーの入力として使用します。

. NetApp Cloud Central にログインすると、Fabric View 画面が表示されます。 Cloud Volumes ONTAPタブを見つけて、「Go to Cloud Manager」を選択します。ログインすると、Canvas 画面が表示されます。
+
image:gcve-cvo-guest-001.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. Cloud Manager Canvas タブで、「作業環境の追加」をクリックし、クラウドとして Google Cloud Platform を選択し、システム構成のタイプを選択します。次に、「次へ」をクリックします。
+
image:gcve-cvo-guest-002.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 環境名や管理者の資格情報など、作成する環境の詳細を指定します。完了したら、「続行」をクリックします。
+
image:gcve-cvo-guest-003.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. Data Sense & Compliance や Backup to Cloud など、 Cloud Volumes ONTAPデプロイメントのアドオン サービスを選択または選択解除します。次に、「続行」をクリックします。
+
ヒント: アドオン サービスを非アクティブ化すると、確認のポップアップ メッセージが表示されます。アドオン サービスは CVO の導入後に追加/削除できますが、コストを避けるために最初から必要ない場合は選択解除することを検討してください。

+
image:gcve-cvo-guest-004.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 場所を選択し、ファイアウォール ポリシーを選択して、チェックボックスをオンにして、Google Cloud ストレージへのネットワーク接続を確認します。
+
image:gcve-cvo-guest-005.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 既存のライセンスを使用する場合は、ライセンス オプション (Pay-As-You-Go または BYOL) を選択します。この例では、Freemium オプションが使用されています。次に、「続行」をクリックします。
+
image:gcve-cvo-guest-006.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. VMware Cloud on AWS SDDC で実行されている VM に展開されるワークロードのタイプに基づいて、利用可能ないくつかの事前構成済みパッケージから選択します。
+
ヒント: タイルの上にマウスを移動すると詳細が表示されます。また、[構成の変更] をクリックして CVO コンポーネントとONTAPバージョンをカスタマイズすることもできます。

+
image:gcve-cvo-guest-007.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. [確認と承認] ページで、選択内容を確認して確定しますCloud Volumes ONTAPインスタンスを作成するには、[実行] をクリックします。
+
image:gcve-cvo-guest-008.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. Cloud Volumes ONTAPがプロビジョニングされると、Canvas ページの作業環境にリストされます。
+
image:gcve-cvo-guest-009.png["入出力ダイアログまたは書かれたコンテンツを示す図"]



====
.SMBボリュームの追加構成
[%collapsible%open]
====
. 作業環境の準備ができたら、CIFS サーバーが適切な DNS および Active Directory 構成パラメータで構成されていることを確認します。  SMB ボリュームを作成する前にこの手順を実行する必要があります。
+
ヒント: メニュー アイコン (º) をクリックし、[詳細設定] を選択してその他のオプションを表示し、[CIFS セットアップ] を選択します。

+
image:gcve-cvo-guest-010.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. SMB ボリュームの作成は簡単なプロセスです。 Canvas で、 Cloud Volumes ONTAP作業環境をダブルクリックしてボリュームを作成および管理し、[ボリュームの作成] オプションをクリックします。適切なサイズを選択すると、クラウド マネージャーはそれを含むアグリゲートを選択するか、高度な割り当てメカニズムを使用して特定のアグリゲートに配置します。このデモでは、プロトコルとして CIFS/SMB が選択されています。
+
image:gcve-cvo-guest-011.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. ボリュームがプロビジョニングされると、ボリューム ペインで使用できるようになります。 CIFS 共有がプロビジョニングされているため、ユーザーまたはグループにファイルとフォルダーへの権限を与え、それらのユーザーが共有にアクセスしてファイルを作成できることを確認します。ボリュームがオンプレミス環境から複製される場合、ファイルとフォルダの権限はすべてSnapMirrorレプリケーションの一部として保持されるため、この手順は必要ありません。
+
ヒント: 音量メニュー (º) をクリックするとオプションが表示されます。

+
image:gcve-cvo-guest-012.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. ボリュームが作成されたら、マウント コマンドを使用してボリュームの接続手順を表示し、Google Cloud VMware Engine 上の VM から共有に接続します。
+
image:gcve-cvo-guest-013.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 次のパスをコピーし、ネットワーク ドライブのマップ オプションを使用して、Google Cloud VMware Engine で実行されている VM にボリュームをマウントします。
+
image:gcve-cvo-guest-014.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+
一度マップすると、簡単にアクセスできるようになり、それに応じて NTFS アクセス許可を設定できます。

+
image:gcve-cvo-guest-015.png["入出力ダイアログまたは書かれたコンテンツを示す図"]



====
.Cloud Volumes ONTAP上のLUNをホストに接続する
[%collapsible%open]
====
クラウド ボリュームONTAP LUN をホストに接続するには、次の手順を実行します。

. Canvas ページで、 Cloud Volumes ONTAP作業環境をダブルクリックして、ボリュームを作成および管理します。
. [ボリュームの追加] > [新しいボリューム] をクリックし、[iSCSI] を選択して [イニシエーター グループの作成] をクリックします。[Continue]をクリックします。
+
image:gcve-cvo-guest-016.png["入出力ダイアログまたは書かれたコンテンツを示す図"] image:gcve-cvo-guest-017.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. ボリュームがプロビジョニングされたら、ボリューム メニュー (º) を選択し、[ターゲット iQN] をクリックします。 iSCSI 修飾名 (iQN) をコピーするには、[コピー] をクリックします。ホストから LUN への iSCSI 接続を設定します。


Google Cloud VMware Engine 上にあるホストで同じことを実現するには、次の手順を実行します。

. Google Cloud VMware Engine でホストされている VM に RDP 接続します。
. iSCSI イニシエーターのプロパティ ダイアログ ボックスを開きます: サーバー マネージャー > ダッシュボード > ツール > iSCSI イニシエーター。
. [検出] タブで、[ポータルの検出] または [ポータルの追加] をクリックし、iSCSI ターゲット ポートの IP アドレスを入力します。
. [ターゲット] タブで、検出されたターゲットを選択し、[ログオン] または [接続] をクリックします。
. [マルチパスを有効にする] を選択し、[コンピューターの起動時にこの接続を自動的に復元する] または [この接続をお気に入りのターゲットのリストに追加する] を選択します。[Advanced]をクリックします。
+

NOTE: Windowsホストには、クラスタ内のそれぞれのノードへのiSCSI接続が必要です。標準のDSMによって最適なパスが選択され、

+
image:gcve-cvo-guest-018.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+
ストレージ仮想マシン (SVM) 上の LUN は、Windows ホストに対してディスクとして表示されます。追加された新しいディスクは、ホストによって自動的に検出されません。次の手順を実行して、手動での再スキャンをトリガーし、ディスクを検出します。

+
.. Windows のコンピューターの管理ユーティリティを開きます (スタート > 管理ツール > コンピューターの管理)。
.. ナビゲーション ツリーでストレージ ノードを展開します。
.. ディスクの管理をクリックします。
.. [アクション] > [ディスクの再スキャン] をクリックします。
+
image:gcve-cvo-guest-019.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+
Windowsホストから初めてアクセスした時点では、新しいLUNにはパーティションやファイルシステムは設定されていません。LUN を初期化し、オプションで次の手順を実行して、LUN をファイル システムでフォーマットします。

.. Windowsの[ディスクの管理]を起動します。
.. LUNを右クリックし、必要なディスクまたはパーティションの種類を選択します。
.. ウィザードの指示に従います。この例では、ドライブ F: がマウントされます。




image:gcve-cvo-guest-020.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

Linux クライアントで、iSCSI デーモンが実行されていることを確認します。 LUN がプロビジョニングされたら、Ubuntu を例として iSCSI 構成に関する詳細なガイダンスをここで参照してください。確認するには、シェルから lsblk cmd を実行します。

image:gcve-cvo-guest-021.png["入出力ダイアログまたは書かれたコンテンツを示す図"] image:gcve-cvo-guest-022.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

====
.LinuxクライアントにCloud Volumes ONTAP NFSボリュームをマウントする
[%collapsible%open]
====
Google Cloud VMware Engine 内の VM からCloud Volumes ONTAP （DIY）ファイル システムをマウントするには、次の手順に従います。

以下の手順に従ってボリュームをプロビジョニングします。

. [ボリューム] タブで、[新しいボリュームの作成] をクリックします。
. [新しいボリュームの作成] ページで、ボリュームの種類を選択します。
+
image:gcve-cvo-guest-023.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. [ボリューム] タブで、ボリュームの上にマウス カーソルを置き、メニュー アイコン (º) を選択して、[マウント コマンド] をクリックします。
+
image:gcve-cvo-guest-024.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. [コピー]をクリックします。
. 指定された Linux インスタンスに接続します。
. セキュア シェル (SSH) を使用してインスタンス上でターミナルを開き、適切な資格情報でログインします。
. 次のコマンドを使用して、ボリュームのマウント ポイントのディレクトリを作成します。
+
 $ sudo mkdir /cvogcvetst
+
image:gcve-cvo-guest-025.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 前の手順で作成したディレクトリにCloud Volumes ONTAP NFS ボリュームをマウントします。
+
 sudo mount 10.0.6.251:/cvogcvenfsvol01 /cvogcvetst
+
image:gcve-cvo-guest-026.png["入出力ダイアログまたは書かれたコンテンツを示す図"] image:gcve-cvo-guest-027.png["入出力ダイアログまたは書かれたコンテンツを示す図"]



====


== Google Cloud NetApp Volumes(NetAppボリューム)

Google Cloud NetApp Volumes (NetApp Volumes) は、高度なクラウド ソリューションを提供するためのデータ サービスの完全なポートフォリオです。  NetApp Volumes は、主要なクラウド プロバイダーの複数のファイル アクセス プロトコル (NFS および SMB サポート) をサポートしています。

その他の利点と機能には、スナップショットによるデータ保護と復元、オンプレミスまたはクラウド内のデータの保存先を複製、同期、移行するための特別な機能、専用フラッシュ ストレージ システム レベルの一貫した高パフォーマンスなどがあります。



=== ゲスト接続ストレージとしてのGoogle Cloud NetApp Volumes (NetApp Volumes)

.VMware Engine でNetApp Volumes を構成する
[%collapsible%open]
====
Google Cloud NetApp Volumes共有は、VMware Engine 環境で作成された VM からマウントできます。  Google Cloud NetApp Volumes はSMB および NFS プロトコルをサポートしているため、ボリュームを Linux クライアントにマウントし、Windows クライアントにマップすることもできます。  Google Cloud NetApp Volumesボリュームは簡単な手順で設定できます。

Google Cloud NetApp Volumesと Google Cloud VMware Engine プライベート クラウドは同じリージョンに存在する必要があります。

Google Cloud MarketplaceからGoogle Cloud NetApp Volumes for Google Cloudを購入、有効化、設定するには、以下の詳細な手順に従ってください。link:https://cloud.google.com/vmware-engine/docs/quickstart-prerequisites["ガイド"] 。

====
.GCVEプライベートクラウドにNetApp Volumes NFSボリュームを作成する
[%collapsible%open]
====
NFS ボリュームを作成してマウントするには、次の手順を実行します。

. Google クラウド コンソール内のパートナー ソリューションから Cloud Volumes にアクセスします。
+
image:gcve-cvs-guest-001.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. Cloud Volumes コンソールで、「ボリューム」ページに移動し、「作成」をクリックします。
+
image:gcve-cvs-guest-002.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 「ファイル システムの作成」ページで、チャージバック メカニズムに必要なボリューム名と課金ラベルを指定します。
+
image:gcve-cvs-guest-003.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 適切なサービスを選択してください。  GCVE の場合、アプリケーションのワークロード要件に基づいて、レイテンシの改善とパフォーマンスの向上を実現するために、 NetApp Volumes-Performance と必要なサービス レベルを選択します。
+
image:gcve-cvs-guest-004.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. ボリュームとボリューム パスの Google Cloud リージョンを指定します (ボリューム パスは、プロジェクト内のすべてのクラウド ボリュームで一意である必要があります)
+
image:gcve-cvs-guest-005.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. ボリュームのパフォーマンス レベルを選択します。
+
image:gcve-cvs-guest-006.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. ボリュームのサイズとプロトコルの種類を指定します。このテストでは、NFSv3 が使用されます。
+
image:gcve-cvs-guest-007.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. このステップでは、ボリュームにアクセスできる VPC ネットワークを選択します。  VPC ピアリングが確立されていることを確認します。
+
ヒント: VPC ピアリングが実行されていない場合は、ピアリング コマンドを案内するポップアップ ボタンが表示されます。 Cloud Shell セッションを開き、適切なコマンドを実行して、VPC をGoogle Cloud NetApp Volumesプロデューサーとピアリングします。事前に VPC ピアリングを準備する場合は、こちらの手順を参照してください。

+
image:gcve-cvs-guest-008.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 適切なルールを追加してエクスポート ポリシー ルールを管理し、対応する NFS バージョンのチェック ボックスを選択します。
+
注意: エクスポート ポリシーが追加されない限り、NFS ボリュームにアクセスすることはできません。

+
image:gcve-cvs-guest-009.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 「保存」をクリックしてボリュームを作成します。
+
image:gcve-cvs-guest-010.png["入出力ダイアログまたは書かれたコンテンツを示す図"]



====
.VMware Engine 上で実行されている VM への NFS エクスポートのマウント
[%collapsible%open]
====
NFS ボリュームをマウントする準備をする前に、プライベート接続のピアリング ステータスがアクティブとしてリストされていることを確認してください。ステータスがアクティブになったら、マウント コマンドを使用します。

NFS ボリュームをマウントするには、次の手順を実行します。

. Cloud Console で、[Cloud Volumes] > [ボリューム] に移動します。
. ボリュームページへ
. NFS エクスポートをマウントする NFS ボリュームをクリックします。
. 右にスクロールし、「詳細を表示」の下の「マウント手順」をクリックします。


VMware VM のゲスト OS 内からマウント プロセスを実行するには、次の手順に従います。

. SSH クライアントを使用して仮想マシンに SSH 接続します。
. インスタンスに NFS クライアントをインストールします。
+
.. Red Hat Enterprise Linux または SuSE Linux インスタンスの場合:
+
 sudo yum install -y nfs-utils
.. Ubuntu または Debian インスタンスの場合:
+
 sudo apt-get install nfs-common


. インスタンスに「/nimCVSNFSol01」などの新しいディレクトリを作成します。
+
 sudo mkdir /nimCVSNFSol01
+
image:gcve-cvs-guest-020.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 適切なコマンドを使用してボリュームをマウントします。ラボからのコマンドの例は次のとおりです。
+
 sudo mount -t nfs -o rw,hard,rsize=65536,wsize=65536,vers=3,tcp 10.53.0.4:/nimCVSNFSol01 /nimCVSNFSol01
+
image:gcve-cvs-guest-021.png["入出力ダイアログまたは書かれたコンテンツを示す図"] image:gcve-cvs-guest-022.png["入出力ダイアログまたは書かれたコンテンツを示す図"]



====
.VMware Engine 上で実行されている VM への SMB 共有の作成とマウント
[%collapsible%open]
====
SMB ボリュームの場合、SMB ボリュームを作成する前に Active Directory 接続が構成されていることを確認してください。

image:gcve-cvs-guest-030.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

AD 接続が確立されたら、必要なサービス レベルでボリュームを作成します。適切なプロトコルを選択することを除いて、手順は NFS ボリュームを作成する場合と同様です。

. Cloud Volumes コンソールで、「ボリューム」ページに移動し、「作成」をクリックします。
. 「ファイル システムの作成」ページで、チャージバック メカニズムに必要なボリューム名と課金ラベルを指定します。
+
image:gcve-cvs-guest-031.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 適切なサービスを選択してください。  GCVE の場合、 NetApp Volumes-Performance と、ワークロード要件に基づいてレイテンシの改善とパフォーマンスの向上を図る必要なサービス レベルを選択します。
+
image:gcve-cvs-guest-032.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. ボリュームとボリューム パスの Google Cloud リージョンを指定します (ボリューム パスは、プロジェクト内のすべてのクラウド ボリュームで一意である必要があります)
+
image:gcve-cvs-guest-033.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. ボリュームのパフォーマンス レベルを選択します。
+
image:gcve-cvs-guest-034.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. ボリュームのサイズとプロトコルの種類を指定します。このテストでは、SMB が使用されます。
+
image:gcve-cvs-guest-035.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. このステップでは、ボリュームにアクセスできる VPC ネットワークを選択します。  VPC ピアリングが確立されていることを確認します。
+
ヒント: VPC ピアリングが実行されていない場合は、ピアリング コマンドを案内するポップアップ ボタンが表示されます。 Cloud Shell セッションを開き、適切なコマンドを実行して、VPC をGoogle Cloud NetApp Volumesプロデューサーとピアリングします。事前にVPCピアリングを準備する場合は、以下を参照してください。link:https://cloud.google.com/architecture/partners/netapp-cloud-volumes/setting-up-private-services-access?hl=en["確認方法"] 。

+
image:gcve-cvs-guest-036.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 「保存」をクリックしてボリュームを作成します。
+
image:gcve-cvs-guest-037.png["入出力ダイアログまたは書かれたコンテンツを示す図"]



SMB ボリュームをマウントするには、次の手順を実行します。

. Cloud Console で、[Cloud Volumes] > [ボリューム] に移動します。
. ボリュームページへ
. SMB 共有をマップする SMB ボリュームをクリックします。
. 右にスクロールし、「詳細を表示」の下の「マウント手順」をクリックします。


VMware VM の Windows ゲスト OS 内からマウント プロセスを実行するには、次の手順に従います。

. [スタート] ボタンをクリックし、[コンピューター] をクリックします。
. [ネットワーク ドライブの割り当て]をクリックします。
. ドライブ リストで、使用可能なドライブ文字をクリックします。
. フォルダー ボックスに次のように入力します。
+
 \\nimsmb-3830.nimgcveval.com\nimCVSMBvol01
+
image:gcve-cvs-guest-038.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+
コンピュータにログオンするたびに接続するには、[サインイン時に再接続する] チェック ボックスをオンにします。

. [Finish]をクリックします。
+
image:gcve-cvs-guest-039.png["入出力ダイアログまたは書かれたコンテンツを示す図"]



====